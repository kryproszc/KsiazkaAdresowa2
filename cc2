def update_ratios():
    user_data.modal_html.set(HTML(""))  # ğŸ§¹ wyczyÅ›Ä‡ stary komunikat

    data_list = user_data.reactive_data_paid_list.get()
    if not data_list or data_list[-1] is None:
        user_data.ratio_df_p.set(None)
        user_data.binary_df_p.set(None)
        return

    df = data_list[-1]

    try:
        ratio_df = calculate_ratios_vectorized(df)

        # ğŸ’£ DODAJ TEN WARUNEK â€” jeÅ›li DataFrame jest pusty, zakoÅ„cz
        if ratio_df is None or ratio_df.empty:
            raise ValueError("Brak danych do wyliczenia wspÃ³Å‚czynnikÃ³w.")

        bin_df = create_binary_df(ratio_df)
        user_data.ratio_df_p.set(ratio_df)
        user_data.binary_df_p.set(bin_df)

        if user_data.dev_all_initial.get() is None:
            dev_all = calculator.calculate_dev(df, bin_df, ratio_df)
            user_data.dev_all_initial.set(dev_all)

    except Exception as e:
        show_info_modal(f"âŒâŒ BÅ‚Ä…d przy przetwarzaniu Paid: {e}", error=True)
